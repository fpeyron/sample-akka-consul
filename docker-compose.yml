version: '3.0'
services:
  sample-redis:
    container_name: sample-redis
    image: redis:latest
    #command: consul agent -server -client=0.0.0.0 -bootstrap-expect=1 -data-dir=/tmp/consul -ui
    hostname: sample-redis
    networks:
      - sample
    ports:
      - "16379:6379"

  sample-akka1:
    container_name: sample-akka1
    image: sample-akka-consul:latest
    hostname: sample-akka1
    networks:
      - sample
    depends_on:
      - sample-redis
    ports:
      - "5001:5000"
      - "5011:5010"
      - "2550"
    environment:
      #- REDIS_HOST=sample-redis
      - REDIS_HOST=ec2-54-77-186-236.eu-west-1.compute.amazonaws.com
      - REDIS_PORT=16379
      - SERVICE_AKKA_HOST=sample-akka1
      - SERVICE_AKKA_PORT=2550

  sample-akka2:
    container_name: sample-akka2
    image: sample-akka-consul:latest
    hostname: sample-akka2
    networks:
      - sample
    depends_on:
      - sample-redis
    ports:
      - "5002:5000"
      - "5012:5010"
      - "2550"
    environment:
      #- REDIS_HOST=sample-redis
      - REDIS_HOST=ec2-54-77-186-236.eu-west-1.compute.amazonaws.com
      - REDIS_PORT=16379
      - SERVICE_AKKA_HOST=sample-akka2
      - SERVICE_AKKA_PORT=2550

  sample-akka3:
    container_name: sample-akka3
    image: sample-akka-consul:latest
    hostname: sample-akka3
    networks:
      - sample
    depends_on:
      - sample-redis
    ports:
      - "5003:5000"
      - "5013:5010"
      - "2550"
    environment:
      #- REDIS_HOST=sample-redis
      - REDIS_HOST=ec2-54-77-186-236.eu-west-1.compute.amazonaws.com
      - REDIS_PORT=16379
      - SERVICE_AKKA_HOST=sample-akka3
      - SERVICE_AKKA_PORT=2550

  sample-akka4:
    container_name: sample-akka4
    image: sample-akka-consul:latest
    hostname: sample-akka4
    networks:
      - sample
    depends_on:
      - sample-redis
    ports:
      - "5004:5000"
      - "5014:5010"
      - "2550"
    environment:
      #- REDIS_HOST=sample-redis
      - REDIS_HOST=ec2-54-77-186-236.eu-west-1.compute.amazonaws.com
      - REDIS_PORT=16379
      - SERVICE_AKKA_HOST=sample-akka4
      - SERVICE_AKKA_PORT=2550

networks:
  sample:
    external:
      name: sample
